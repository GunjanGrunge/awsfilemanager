/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./app.js":
/*!****************!*\
  !*** ./app.js ***!
  \****************/
/***/ (() => {

eval("function _typeof(o) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o; }, _typeof(o); }\nfunction _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(r, l) { var t = null == r ? null : \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t[\"return\"] && (u = t[\"return\"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }\nfunction _arrayWithHoles(r) { if (Array.isArray(r)) return r; }\nfunction _createForOfIteratorHelper(r, e) { var t = \"undefined\" != typeof Symbol && r[Symbol.iterator] || r[\"@@iterator\"]; if (!t) { if (Array.isArray(r) || (t = _unsupportedIterableToArray(r)) || e && r && \"number\" == typeof r.length) { t && (r = t); var _n = 0, F = function F() {}; return { s: F, n: function n() { return _n >= r.length ? { done: !0 } : { done: !1, value: r[_n++] }; }, e: function e(r) { throw r; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var o, a = !0, u = !1; return { s: function s() { t = t.call(r); }, n: function n() { var r = t.next(); return a = r.done, r; }, e: function e(r) { u = !0, o = r; }, f: function f() { try { a || null == t[\"return\"] || t[\"return\"](); } finally { if (u) throw o; } } }; }\nfunction _unsupportedIterableToArray(r, a) { if (r) { if (\"string\" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return \"Object\" === t && r.constructor && (t = r.constructor.name), \"Map\" === t || \"Set\" === t ? Array.from(r) : \"Arguments\" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }\nfunction _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return e; }; var t, e = {}, r = Object.prototype, n = r.hasOwnProperty, o = Object.defineProperty || function (t, e, r) { t[e] = r.value; }, i = \"function\" == typeof Symbol ? Symbol : {}, a = i.iterator || \"@@iterator\", c = i.asyncIterator || \"@@asyncIterator\", u = i.toStringTag || \"@@toStringTag\"; function define(t, e, r) { return Object.defineProperty(t, e, { value: r, enumerable: !0, configurable: !0, writable: !0 }), t[e]; } try { define({}, \"\"); } catch (t) { define = function define(t, e, r) { return t[e] = r; }; } function wrap(t, e, r, n) { var i = e && e.prototype instanceof Generator ? e : Generator, a = Object.create(i.prototype), c = new Context(n || []); return o(a, \"_invoke\", { value: makeInvokeMethod(t, r, c) }), a; } function tryCatch(t, e, r) { try { return { type: \"normal\", arg: t.call(e, r) }; } catch (t) { return { type: \"throw\", arg: t }; } } e.wrap = wrap; var h = \"suspendedStart\", l = \"suspendedYield\", f = \"executing\", s = \"completed\", y = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var p = {}; define(p, a, function () { return this; }); var d = Object.getPrototypeOf, v = d && d(d(values([]))); v && v !== r && n.call(v, a) && (p = v); var g = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(p); function defineIteratorMethods(t) { [\"next\", \"throw\", \"return\"].forEach(function (e) { define(t, e, function (t) { return this._invoke(e, t); }); }); } function AsyncIterator(t, e) { function invoke(r, o, i, a) { var c = tryCatch(t[r], t, o); if (\"throw\" !== c.type) { var u = c.arg, h = u.value; return h && \"object\" == _typeof(h) && n.call(h, \"__await\") ? e.resolve(h.__await).then(function (t) { invoke(\"next\", t, i, a); }, function (t) { invoke(\"throw\", t, i, a); }) : e.resolve(h).then(function (t) { u.value = t, i(u); }, function (t) { return invoke(\"throw\", t, i, a); }); } a(c.arg); } var r; o(this, \"_invoke\", { value: function value(t, n) { function callInvokeWithMethodAndArg() { return new e(function (e, r) { invoke(t, n, e, r); }); } return r = r ? r.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(e, r, n) { var o = h; return function (i, a) { if (o === f) throw Error(\"Generator is already running\"); if (o === s) { if (\"throw\" === i) throw a; return { value: t, done: !0 }; } for (n.method = i, n.arg = a;;) { var c = n.delegate; if (c) { var u = maybeInvokeDelegate(c, n); if (u) { if (u === y) continue; return u; } } if (\"next\" === n.method) n.sent = n._sent = n.arg;else if (\"throw\" === n.method) { if (o === h) throw o = s, n.arg; n.dispatchException(n.arg); } else \"return\" === n.method && n.abrupt(\"return\", n.arg); o = f; var p = tryCatch(e, r, n); if (\"normal\" === p.type) { if (o = n.done ? s : l, p.arg === y) continue; return { value: p.arg, done: n.done }; } \"throw\" === p.type && (o = s, n.method = \"throw\", n.arg = p.arg); } }; } function maybeInvokeDelegate(e, r) { var n = r.method, o = e.iterator[n]; if (o === t) return r.delegate = null, \"throw\" === n && e.iterator[\"return\"] && (r.method = \"return\", r.arg = t, maybeInvokeDelegate(e, r), \"throw\" === r.method) || \"return\" !== n && (r.method = \"throw\", r.arg = new TypeError(\"The iterator does not provide a '\" + n + \"' method\")), y; var i = tryCatch(o, e.iterator, r.arg); if (\"throw\" === i.type) return r.method = \"throw\", r.arg = i.arg, r.delegate = null, y; var a = i.arg; return a ? a.done ? (r[e.resultName] = a.value, r.next = e.nextLoc, \"return\" !== r.method && (r.method = \"next\", r.arg = t), r.delegate = null, y) : a : (r.method = \"throw\", r.arg = new TypeError(\"iterator result is not an object\"), r.delegate = null, y); } function pushTryEntry(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e); } function resetTryEntry(t) { var e = t.completion || {}; e.type = \"normal\", delete e.arg, t.completion = e; } function Context(t) { this.tryEntries = [{ tryLoc: \"root\" }], t.forEach(pushTryEntry, this), this.reset(!0); } function values(e) { if (e || \"\" === e) { var r = e[a]; if (r) return r.call(e); if (\"function\" == typeof e.next) return e; if (!isNaN(e.length)) { var o = -1, i = function next() { for (; ++o < e.length;) if (n.call(e, o)) return next.value = e[o], next.done = !1, next; return next.value = t, next.done = !0, next; }; return i.next = i; } } throw new TypeError(_typeof(e) + \" is not iterable\"); } return GeneratorFunction.prototype = GeneratorFunctionPrototype, o(g, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), o(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, u, \"GeneratorFunction\"), e.isGeneratorFunction = function (t) { var e = \"function\" == typeof t && t.constructor; return !!e && (e === GeneratorFunction || \"GeneratorFunction\" === (e.displayName || e.name)); }, e.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, GeneratorFunctionPrototype) : (t.__proto__ = GeneratorFunctionPrototype, define(t, u, \"GeneratorFunction\")), t.prototype = Object.create(g), t; }, e.awrap = function (t) { return { __await: t }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, c, function () { return this; }), e.AsyncIterator = AsyncIterator, e.async = function (t, r, n, o, i) { void 0 === i && (i = Promise); var a = new AsyncIterator(wrap(t, r, n, o), i); return e.isGeneratorFunction(r) ? a : a.next().then(function (t) { return t.done ? t.value : a.next(); }); }, defineIteratorMethods(g), define(g, u, \"Generator\"), define(g, a, function () { return this; }), define(g, \"toString\", function () { return \"[object Generator]\"; }), e.keys = function (t) { var e = Object(t), r = []; for (var n in e) r.push(n); return r.reverse(), function next() { for (; r.length;) { var t = r.pop(); if (t in e) return next.value = t, next.done = !1, next; } return next.done = !0, next; }; }, e.values = values, Context.prototype = { constructor: Context, reset: function reset(e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = t, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = t, this.tryEntries.forEach(resetTryEntry), !e) for (var r in this) \"t\" === r.charAt(0) && n.call(this, r) && !isNaN(+r.slice(1)) && (this[r] = t); }, stop: function stop() { this.done = !0; var t = this.tryEntries[0].completion; if (\"throw\" === t.type) throw t.arg; return this.rval; }, dispatchException: function dispatchException(e) { if (this.done) throw e; var r = this; function handle(n, o) { return a.type = \"throw\", a.arg = e, r.next = n, o && (r.method = \"next\", r.arg = t), !!o; } for (var o = this.tryEntries.length - 1; o >= 0; --o) { var i = this.tryEntries[o], a = i.completion; if (\"root\" === i.tryLoc) return handle(\"end\"); if (i.tryLoc <= this.prev) { var c = n.call(i, \"catchLoc\"), u = n.call(i, \"finallyLoc\"); if (c && u) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } else if (c) { if (this.prev < i.catchLoc) return handle(i.catchLoc, !0); } else { if (!u) throw Error(\"try statement without catch or finally\"); if (this.prev < i.finallyLoc) return handle(i.finallyLoc); } } } }, abrupt: function abrupt(t, e) { for (var r = this.tryEntries.length - 1; r >= 0; --r) { var o = this.tryEntries[r]; if (o.tryLoc <= this.prev && n.call(o, \"finallyLoc\") && this.prev < o.finallyLoc) { var i = o; break; } } i && (\"break\" === t || \"continue\" === t) && i.tryLoc <= e && e <= i.finallyLoc && (i = null); var a = i ? i.completion : {}; return a.type = t, a.arg = e, i ? (this.method = \"next\", this.next = i.finallyLoc, y) : this.complete(a); }, complete: function complete(t, e) { if (\"throw\" === t.type) throw t.arg; return \"break\" === t.type || \"continue\" === t.type ? this.next = t.arg : \"return\" === t.type ? (this.rval = this.arg = t.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === t.type && e && (this.next = e), y; }, finish: function finish(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.finallyLoc === t) return this.complete(r.completion, r.afterLoc), resetTryEntry(r), y; } }, \"catch\": function _catch(t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var r = this.tryEntries[e]; if (r.tryLoc === t) { var n = r.completion; if (\"throw\" === n.type) { var o = n.arg; resetTryEntry(r); } return o; } } throw Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(e, r, n) { return this.delegate = { iterator: values(e), resultName: r, nextLoc: n }, \"next\" === this.method && (this.arg = t), y; } }, e; }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\n// Declare global variables at the top\nvar _fetchS3Contents;\nvar currentPrefix = '';\nvar history = [];\ndocument.addEventListener('DOMContentLoaded', /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee12() {\n  var firebaseConfig, auth, app, showMainUI, showLoginPage, handleLogin, _handleLogin, s3, formatFileSize, formatDate, updateBreadcrumb, updateHistory, _updateHistory, loadHistory, _loadHistory, fetchAWSCost, _fetchAWSCost, uploadFiles, _uploadFiles, showToast;\n  return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n    while (1) switch (_context12.prev = _context12.next) {\n      case 0:\n        showToast = function _showToast(message) {\n          var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n          var duration = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 5000;\n          var toastId = \"toast-\".concat(Date.now());\n          var toastHTML = \"\\n            <div id=\\\"\".concat(toastId, \"\\\" class=\\\"toast\\\" role=\\\"alert\\\" aria-live=\\\"assertive\\\" aria-atomic=\\\"true\\\" data-delay=\\\"\").concat(duration, \"\\\">\\n                <div class=\\\"toast-header bg-\").concat(type, \" text-white\\\">\\n                    <strong class=\\\"mr-auto\\\">\").concat(type.charAt(0).toUpperCase() + type.slice(1), \"</strong>\\n                    <button type=\\\"button\\\" class=\\\"ml-2 mb-1 close text-white\\\" data-dismiss=\\\"toast\\\" aria-label=\\\"Close\\\">\\n                        <span aria-hidden=\\\"true\\\">&times;</span>\\n                    </button>\\n                </div>\\n                <div class=\\\"toast-body\\\">\\n                    \").concat(message, \"\\n                </div>\\n            </div>\\n        \");\n          $('#toast-container').append(toastHTML);\n          $(\"#\".concat(toastId)).toast('show').on('hidden.bs.toast', function () {\n            $(this).remove();\n          });\n        };\n        _uploadFiles = function _uploadFiles3() {\n          _uploadFiles = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee11(files, currentPrefix) {\n            var uploadProgress, progressBar, progressBarInner, _iterator2, _step2, file, key, params;\n            return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n              while (1) switch (_context11.prev = _context11.next) {\n                case 0:\n                  uploadProgress = {\n                    total: files.length,\n                    current: 0,\n                    size: 0\n                  };\n                  progressBar = document.getElementById('upload-progress');\n                  progressBarInner = progressBar.querySelector('.progress-bar');\n                  _iterator2 = _createForOfIteratorHelper(files);\n                  _context11.prev = 4;\n                  _iterator2.s();\n                case 6:\n                  if ((_step2 = _iterator2.n()).done) {\n                    _context11.next = 24;\n                    break;\n                  }\n                  file = _step2.value;\n                  _context11.prev = 8;\n                  key = currentPrefix + (file.webkitRelativePath || file.name);\n                  params = {\n                    Bucket: \"awsmusicbackupbucket\",\n                    Key: key,\n                    Body: file,\n                    ContentType: file.type\n                  };\n                  _context11.next = 13;\n                  return s3.upload(params).on('httpUploadProgress', function (progress) {\n                    var percent = Math.round(progress.loaded / progress.total * 100);\n                    progressBarInner.style.width = \"\".concat(percent, \"%\");\n                    progressBarInner.textContent = \"\".concat(percent, \"%\");\n                  }).promise();\n                case 13:\n                  uploadProgress.current++;\n                  uploadProgress.size += file.size;\n\n                  // Update progress every 5 files\n                  if (uploadProgress.current % 5 === 0) {\n                    showToast(\"Uploaded \".concat(uploadProgress.current, \" of \").concat(uploadProgress.total, \" files\"), 'info');\n                  }\n                  _context11.next = 22;\n                  break;\n                case 18:\n                  _context11.prev = 18;\n                  _context11.t0 = _context11[\"catch\"](8);\n                  console.error(\"Error uploading file \".concat(file.name, \":\"), _context11.t0);\n                  showToast(\"Failed to upload \".concat(file.name), 'danger');\n                case 22:\n                  _context11.next = 6;\n                  break;\n                case 24:\n                  _context11.next = 29;\n                  break;\n                case 26:\n                  _context11.prev = 26;\n                  _context11.t1 = _context11[\"catch\"](4);\n                  _iterator2.e(_context11.t1);\n                case 29:\n                  _context11.prev = 29;\n                  _iterator2.f();\n                  return _context11.finish(29);\n                case 32:\n                  return _context11.abrupt(\"return\", uploadProgress);\n                case 33:\n                case \"end\":\n                  return _context11.stop();\n              }\n            }, _callee11, null, [[4, 26, 29, 32], [8, 18]]);\n          }));\n          return _uploadFiles.apply(this, arguments);\n        };\n        uploadFiles = function _uploadFiles2(_x7, _x8) {\n          return _uploadFiles.apply(this, arguments);\n        };\n        _fetchAWSCost = function _fetchAWSCost3() {\n          _fetchAWSCost = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee10() {\n            var costDetails, costExplorer, params, data, costUSD, exchangeRate, costINR;\n            return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n              while (1) switch (_context10.prev = _context10.next) {\n                case 0:\n                  costDetails = document.getElementById('cost-details');\n                  if (costDetails) {\n                    _context10.next = 4;\n                    break;\n                  }\n                  console.error('Cost details element not found');\n                  return _context10.abrupt(\"return\");\n                case 4:\n                  _context10.prev = 4;\n                  costDetails.innerHTML = \"\\n                <div class=\\\"spinner-border text-primary\\\" role=\\\"status\\\">\\n                    <span class=\\\"sr-only\\\">Loading...</span>\\n                </div>\\n            \";\n                  costExplorer = new AWS.CostExplorer({\n                    region: 'us-east-1'\n                  });\n                  params = {\n                    TimePeriod: {\n                      Start: new Date(new Date().setDate(1)).toISOString().split('T')[0],\n                      End: new Date().toISOString().split('T')[0]\n                    },\n                    Granularity: 'MONTHLY',\n                    Metrics: ['UnblendedCost']\n                  };\n                  _context10.next = 10;\n                  return costExplorer.getCostAndUsage(params).promise();\n                case 10:\n                  data = _context10.sent;\n                  costUSD = parseFloat(data.ResultsByTime[0].Total.UnblendedCost.Amount); // Convert USD to INR (using a fixed rate for example, you might want to use a real-time conversion API)\n                  exchangeRate = 83; // Current approximate USD to INR rate\n                  costINR = costUSD * exchangeRate;\n                  costDetails.innerHTML = \"\\n                <div class=\\\"cost-info\\\">\\n                    <div class=\\\"current-cost mb-3\\\">\\n                        <h6>Current Month Cost</h6>\\n                        <h2 class=\\\"text-success\\\">\\u20B9\".concat(costINR.toFixed(2), \"</h2>\\n                        <small class=\\\"text-muted\\\">($\").concat(costUSD.toFixed(2), \")</small>\\n                    </div>\\n                    <div class=\\\"cost-date text-muted\\\">\\n                        <small>Period: \").concat(params.TimePeriod.Start, \" to \").concat(params.TimePeriod.End, \"</small>\\n                    </div>\\n                </div>\\n            \");\n                  _context10.next = 22;\n                  break;\n                case 17:\n                  _context10.prev = 17;\n                  _context10.t0 = _context10[\"catch\"](4);\n                  console.error('Error fetching AWS cost:', _context10.t0);\n                  costDetails.innerHTML = \"\\n                <div class=\\\"alert alert-danger\\\">\\n                    Error fetching cost data. Please check your AWS credentials and permissions.\\n                </div>\\n            \";\n                  showToast('Error fetching AWS cost. Please check console for details.', 'danger');\n                case 22:\n                case \"end\":\n                  return _context10.stop();\n              }\n            }, _callee10, null, [[4, 17]]);\n          }));\n          return _fetchAWSCost.apply(this, arguments);\n        };\n        fetchAWSCost = function _fetchAWSCost2() {\n          return _fetchAWSCost.apply(this, arguments);\n        };\n        _loadHistory = function _loadHistory3() {\n          _loadHistory = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9() {\n            var params, data, historyContents;\n            return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n              while (1) switch (_context9.prev = _context9.next) {\n                case 0:\n                  _context9.prev = 0;\n                  params = {\n                    Bucket: \"awsmusicbackupbucket\",\n                    Key: 'history-log.json'\n                  };\n                  _context9.next = 4;\n                  return s3.getObject(params).promise();\n                case 4:\n                  data = _context9.sent;\n                  history = JSON.parse(data.Body.toString());\n                  historyContents = document.getElementById('history-contents');\n                  if (historyContents) {\n                    historyContents.innerHTML = history.map(function (item) {\n                      return \"\\n                    <tr>\\n                        <td>\".concat(item.date, \"</td>\\n                        <td>\").concat(item.action, \"</td>\\n                        <td>\").concat((item.size / (1024 * 1024)).toFixed(2), \" MB</td>\\n                        <td>\").concat(item.fileCount, \"</td>\\n                    </tr>\\n                \");\n                    }).join('');\n                  } else {\n                    console.error('Element not found');\n                  }\n                  _context9.next = 13;\n                  break;\n                case 10:\n                  _context9.prev = 10;\n                  _context9.t0 = _context9[\"catch\"](0);\n                  console.error('Error loading history:', _context9.t0);\n                case 13:\n                case \"end\":\n                  return _context9.stop();\n              }\n            }, _callee9, null, [[0, 10]]);\n          }));\n          return _loadHistory.apply(this, arguments);\n        };\n        loadHistory = function _loadHistory2() {\n          return _loadHistory.apply(this, arguments);\n        };\n        _updateHistory = function _updateHistory3() {\n          _updateHistory = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(action, size, fileCount) {\n            var date, historyContents, params;\n            return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n              while (1) switch (_context8.prev = _context8.next) {\n                case 0:\n                  date = new Date().toLocaleString();\n                  history.push({\n                    date: date,\n                    action: action,\n                    size: size,\n                    fileCount: fileCount\n                  });\n                  historyContents = document.getElementById('history-contents');\n                  if (historyContents) {\n                    historyContents.innerHTML = history.map(function (item) {\n                      return \"\\n                <tr>\\n                    <td>\".concat(item.date, \"</td>\\n                    <td>\").concat(item.action, \"</td>\\n                    <td>\").concat((item.size / (1024 * 1024)).toFixed(2), \" MB</td>\\n                    <td>\").concat(item.fileCount, \"</td>\\n                </tr>\\n            \");\n                    }).join('');\n                  } else {\n                    console.error('Element not found');\n                  }\n\n                  // Save history to S3\n                  params = {\n                    Bucket: \"awsmusicbackupbucket\",\n                    Key: 'history-log.json',\n                    Body: JSON.stringify(history),\n                    ContentType: 'application/json'\n                  };\n                  _context8.next = 7;\n                  return s3.putObject(params).promise();\n                case 7:\n                case \"end\":\n                  return _context8.stop();\n              }\n            }, _callee8);\n          }));\n          return _updateHistory.apply(this, arguments);\n        };\n        updateHistory = function _updateHistory2(_x4, _x5, _x6) {\n          return _updateHistory.apply(this, arguments);\n        };\n        updateBreadcrumb = function _updateBreadcrumb(prefix) {\n          var breadcrumb = document.getElementById('folder-breadcrumb');\n          if (!breadcrumb) {\n            console.error('Breadcrumb element not found');\n            return;\n          }\n          var parts = prefix.split('/').filter(Boolean);\n          var breadcrumbHTML = '<li class=\"breadcrumb-item\"><a href=\"#\" class=\"text-white\" data-prefix=\"\">Root</a></li>';\n          var currentPath = '';\n          parts.forEach(function (part, index) {\n            currentPath += part + '/';\n            var isLast = index === parts.length - 1;\n            breadcrumbHTML += \"\\n                <li class=\\\"breadcrumb-item \".concat(isLast ? 'active' : '', \"\\\">\\n                    \").concat(isLast ? \"<span class=\\\"text-info\\\">\".concat(part, \"</span>\") : \"<a href=\\\"#\\\" class=\\\"text-white\\\" data-prefix=\\\"\".concat(currentPath, \"\\\">\").concat(part, \"</a>\"), \"\\n                </li>\\n            \");\n          });\n          breadcrumb.innerHTML = breadcrumbHTML;\n\n          // Add click handlers to breadcrumb links\n          breadcrumb.querySelectorAll('a').forEach(function (link) {\n            link.addEventListener('click', function (e) {\n              e.preventDefault();\n              _fetchS3Contents(e.target.dataset.prefix || '');\n            });\n          });\n        };\n        formatDate = function _formatDate(date) {\n          return new Date(date).toLocaleString();\n        };\n        formatFileSize = function _formatFileSize(bytes) {\n          if (bytes === 0) return '0 Bytes';\n          var k = 1024;\n          var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n          var i = Math.floor(Math.log(bytes) / Math.log(k));\n          return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n        };\n        _handleLogin = function _handleLogin3() {\n          _handleLogin = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(email, password) {\n            var userCredential, errorMessage;\n            return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n              while (1) switch (_context7.prev = _context7.next) {\n                case 0:\n                  _context7.prev = 0;\n                  _context7.next = 3;\n                  return window.signInWithEmailAndPassword(auth, email, password);\n                case 3:\n                  userCredential = _context7.sent;\n                  showToast('Successfully logged in!', 'success');\n                  return _context7.abrupt(\"return\", userCredential.user);\n                case 8:\n                  _context7.prev = 8;\n                  _context7.t0 = _context7[\"catch\"](0);\n                  errorMessage = 'An error occurred during login.';\n                  _context7.t1 = _context7.t0.code;\n                  _context7.next = _context7.t1 === 'auth/wrong-password' ? 14 : _context7.t1 === 'auth/user-not-found' ? 14 : _context7.t1 === 'auth/too-many-requests' ? 16 : _context7.t1 === 'auth/network-request-failed' ? 18 : 20;\n                  break;\n                case 14:\n                  errorMessage = 'Invalid email or password.';\n                  return _context7.abrupt(\"break\", 20);\n                case 16:\n                  errorMessage = 'Too many failed login attempts. Please try again later.';\n                  return _context7.abrupt(\"break\", 20);\n                case 18:\n                  errorMessage = 'Network error. Please check your connection.';\n                  return _context7.abrupt(\"break\", 20);\n                case 20:\n                  throw new Error(errorMessage);\n                case 21:\n                case \"end\":\n                  return _context7.stop();\n              }\n            }, _callee7, null, [[0, 8]]);\n          }));\n          return _handleLogin.apply(this, arguments);\n        };\n        handleLogin = function _handleLogin2(_x2, _x3) {\n          return _handleLogin.apply(this, arguments);\n        };\n        showLoginPage = function _showLoginPage() {\n          document.getElementById('login-container').classList.remove('d-none');\n          document.getElementById('main-ui').classList.add('d-none');\n        };\n        showMainUI = function _showMainUI(user) {\n          document.getElementById('login-container').classList.add('d-none');\n          document.getElementById('main-ui').classList.remove('d-none');\n          document.getElementById('username').textContent = user.email || 'User';\n\n          // Initialize the main UI components\n          _fetchS3Contents();\n          loadHistory();\n\n          // Show the folders section by default\n          document.getElementById('folders-section').classList.remove('d-none');\n          document.getElementById('history-section').classList.add('d-none');\n        };\n        // Firebase configuration\n        firebaseConfig = {\n          apiKey: \"AIzaSyD27YqMpp5ScjNgsuEP4aZ3gKOPygedMj4\",\n          authDomain: \"awsbackup-f3b1a.firebaseapp.com\",\n          projectId: \"awsbackup-f3b1a\",\n          storageBucket: \"awsbackup-f3b1a.firebasestorage.app\",\n          messagingSenderId: \"210701688284\",\n          appId: \"1:210701688284:web:a15b1364264daae6c28319\"\n        };\n        _context12.prev = 17;\n        app = window.initializeApp(firebaseConfig);\n        auth = window.getAuth(app); // Assign to outer scope variable\n\n        // Move the auth state observer inside the try block\n        window.onAuthStateChanged(auth, function (user) {\n          if (user) {\n            showMainUI(user);\n            // Set up AWS credentials after successful authentication\n            AWS.config.update({\n              region: \"ap-south-1\",\n              credentials: new AWS.Credentials({\n                accessKeyId: \"AKIA253CTSFIXRH5UIHA\",\n                secretAccessKey: \"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\"\n              })\n            });\n          } else {\n            showLoginPage();\n          }\n        });\n        _context12.next = 28;\n        break;\n      case 23:\n        _context12.prev = 23;\n        _context12.t0 = _context12[\"catch\"](17);\n        console.error('Error initializing Firebase:', _context12.t0);\n        showToast('Error initializing application', 'danger');\n        return _context12.abrupt(\"return\");\n      case 28:\n        // Login form submission handler\n        document.getElementById('login-form').addEventListener('submit', /*#__PURE__*/function () {\n          var _ref2 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event) {\n            var email, password, user;\n            return _regeneratorRuntime().wrap(function _callee$(_context) {\n              while (1) switch (_context.prev = _context.next) {\n                case 0:\n                  event.preventDefault();\n                  email = document.getElementById('login-username').value;\n                  password = document.getElementById('login-password').value;\n                  _context.prev = 3;\n                  document.getElementById('login-error-message').classList.add('d-none');\n                  _context.next = 7;\n                  return handleLogin(email, password);\n                case 7:\n                  user = _context.sent;\n                  showMainUI(user);\n                  _context.next = 16;\n                  break;\n                case 11:\n                  _context.prev = 11;\n                  _context.t0 = _context[\"catch\"](3);\n                  console.error('Error during login:', _context.t0);\n                  document.getElementById('login-error-message').classList.remove('d-none');\n                  document.getElementById('login-error-message').textContent = _context.t0.message;\n                case 16:\n                case \"end\":\n                  return _context.stop();\n              }\n            }, _callee, null, [[3, 11]]);\n          }));\n          return function (_x) {\n            return _ref2.apply(this, arguments);\n          };\n        }());\n\n        // Function to handle login with improved error handling\n\n        // Logout button handler\n        document.getElementById('logout-button').addEventListener('click', function () {\n          window.signOut(auth).then(function () {\n            showLoginPage();\n          })[\"catch\"](function (error) {\n            console.error('Error during logout:', error);\n          });\n        });\n\n        // Configure AWS using secrets from environment variables\n        AWS.config.update({\n          region: \"ap-south-1\",\n          credentials: new AWS.Credentials({\n            accessKeyId: \"AKIA253CTSFIXRH5UIHA\",\n            secretAccessKey: \"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\"\n          })\n        });\n\n        // Move s3 initialization to global scope\n        s3 = new AWS.S3({\n          apiVersion: '2006-03-01',\n          params: {\n            Bucket: \"awsmusicbackupbucket\"\n          },\n          signatureVersion: 'v4'\n        }); // Function to format file size\n        // Function to format date\n        // Function to update breadcrumb\n        // Move fetchS3Contents definition to global scope\n        _fetchS3Contents = /*#__PURE__*/function () {\n          var _ref3 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n            var prefix,\n              s3Contents,\n              params,\n              data,\n              contentsHTML,\n              parentPrefix,\n              _args2 = arguments;\n            return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n              while (1) switch (_context2.prev = _context2.next) {\n                case 0:\n                  prefix = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : '';\n                  _context2.prev = 1;\n                  currentPrefix = prefix;\n                  updateBreadcrumb(prefix);\n                  s3Contents = document.getElementById('s3-contents');\n                  if (s3Contents) {\n                    _context2.next = 8;\n                    break;\n                  }\n                  console.error('S3 contents element not found');\n                  return _context2.abrupt(\"return\");\n                case 8:\n                  // Show loading state\n                  s3Contents.innerHTML = \"\\n                <tr>\\n                    <td colspan=\\\"5\\\" class=\\\"text-center\\\">\\n                        <div class=\\\"spinner-border text-primary\\\" role=\\\"status\\\">\\n                            <span class=\\\"sr-only\\\">Loading...</span>\\n                        </div>\\n                    </td>\\n                </tr>\\n            \";\n                  params = {\n                    Bucket: \"awsmusicbackupbucket\",\n                    Prefix: prefix,\n                    Delimiter: '/'\n                  };\n                  _context2.next = 12;\n                  return s3.listObjectsV2(params).promise();\n                case 12:\n                  data = _context2.sent;\n                  if (!(!data.Contents && !data.CommonPrefixes)) {\n                    _context2.next = 16;\n                    break;\n                  }\n                  s3Contents.innerHTML = \"\\n                    <tr>\\n                        <td colspan=\\\"5\\\" class=\\\"text-center\\\">No contents found</td>\\n                    </tr>\\n                \";\n                  return _context2.abrupt(\"return\");\n                case 16:\n                  contentsHTML = ''; // Add parent directory link if not at root\n                  if (prefix) {\n                    parentPrefix = prefix.split('/').slice(0, -2).join('/') + '/';\n                    contentsHTML += \"\\n                    <tr class=\\\"folder-row\\\">\\n                        <td>\\n                            <a href=\\\"#\\\" class=\\\"back-link\\\" data-prefix=\\\"\".concat(parentPrefix, \"\\\">\\n                                <i class=\\\"fas fa-arrow-left\\\"></i>\\n                            </a>\\n                        </td>\\n                        <td colspan=\\\"4\\\">\\n                            Back to parent directory\\n                        </td>\\n                    </tr>\\n                \");\n                  }\n\n                  // Add folders\n                  if (data.CommonPrefixes) {\n                    data.CommonPrefixes.forEach(function (item) {\n                      var folderName = item.Prefix.split('/').slice(-2, -1)[0];\n                      contentsHTML += \"\\n                        <tr class=\\\"folder-row\\\">\\n                            <td><i class=\\\"fas fa-folder folder-icon\\\"></i></td>\\n                            <td><a href=\\\"#\\\" class=\\\"text-decoration-none\\\" data-prefix=\\\"\".concat(item.Prefix, \"\\\">\").concat(folderName, \"</a></td>\\n                            <td class=\\\"file-size\\\">-</td>\\n                            <td class=\\\"last-modified\\\">-</td>\\n                            <td class=\\\"file-actions\\\">\\n                                <button class=\\\"btn btn-sm btn-primary download-folder-button\\\" data-prefix=\\\"\").concat(item.Prefix, \"\\\">\\n                                    <i class=\\\"fas fa-download\\\"></i> Download\\n                                </button>\\n                            </td>\\n                        </tr>\\n                    \");\n                    });\n                  }\n\n                  // Add files\n                  if (data.Contents) {\n                    data.Contents.filter(function (item) {\n                      return item.Key !== prefix && item.Key !== 'history-log.json';\n                    }).forEach(function (item) {\n                      var fileName = item.Key.split('/').pop();\n                      contentsHTML += \"\\n                            <tr>\\n                                <td><i class=\\\"fas fa-file file-icon\\\"></i></td>\\n                                <td>\".concat(fileName, \"</td>\\n                                <td class=\\\"file-size\\\">\").concat(formatFileSize(item.Size), \"</td>\\n                                <td class=\\\"last-modified\\\">\").concat(formatDate(item.LastModified), \"</td>\\n                                <td class=\\\"file-actions\\\">\\n                                    <button class=\\\"btn btn-sm btn-primary download-button\\\" data-key=\\\"\").concat(item.Key, \"\\\">\\n                                        <i class=\\\"fas fa-download\\\"></i> Download\\n                                    </button>\\n                                </td>\\n                            </tr>\\n                        \");\n                    });\n                  }\n                  s3Contents.innerHTML = contentsHTML;\n\n                  // Add click handlers for folder navigation\n                  s3Contents.querySelectorAll('.folder-row a').forEach(function (link) {\n                    link.addEventListener('click', function (e) {\n                      e.preventDefault();\n                      _fetchS3Contents(e.target.dataset.prefix);\n                    });\n                  });\n                  _context2.next = 28;\n                  break;\n                case 24:\n                  _context2.prev = 24;\n                  _context2.t0 = _context2[\"catch\"](1);\n                  console.error('Error fetching S3 contents:', _context2.t0);\n                  showToast('Error fetching S3 contents. Please check console for details.', 'danger');\n                case 28:\n                case \"end\":\n                  return _context2.stop();\n              }\n            }, _callee2, null, [[1, 24]]);\n          }));\n          return function fetchS3Contents() {\n            return _ref3.apply(this, arguments);\n          };\n        }();\n\n        // Function to update history\n\n        // Function to load history from S3\n\n        // Function to fetch AWS cost with INR conversion\n\n        // S3 Info click handler\n        document.getElementById('s3-info-link').addEventListener('click', /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n          var _objects$Contents, _objects$Contents2, params, objects, totalSize, totalFiles, sizeInGB, sizeInMB, sizeInKB, sizeDisplay, bucketDetails, s3InfoContent;\n          return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n            while (1) switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.prev = 0;\n                params = {\n                  Bucket: \"awsmusicbackupbucket\"\n                };\n                _context3.next = 4;\n                return s3.listObjectsV2(params).promise();\n              case 4:\n                objects = _context3.sent;\n                // Calculate total size and counts\n                totalSize = ((_objects$Contents = objects.Contents) === null || _objects$Contents === void 0 ? void 0 : _objects$Contents.reduce(function (acc, obj) {\n                  return acc + obj.Size;\n                }, 0)) || 0;\n                totalFiles = ((_objects$Contents2 = objects.Contents) === null || _objects$Contents2 === void 0 ? void 0 : _objects$Contents2.length) || 0; // Calculate size breakdowns\n                sizeInGB = totalSize / (1024 * 1024 * 1024);\n                sizeInMB = totalSize / (1024 * 1024);\n                sizeInKB = totalSize / 1024; // Get size format based on total size\n                if (sizeInGB >= 1) {\n                  sizeDisplay = \"\".concat(sizeInGB.toFixed(2), \" GB\");\n                } else if (sizeInMB >= 1) {\n                  sizeDisplay = \"\".concat(sizeInMB.toFixed(2), \" MB\");\n                } else {\n                  sizeDisplay = \"\".concat(sizeInKB.toFixed(2), \" KB\");\n                }\n                bucketDetails = \"\\n                <div class=\\\"bucket-info mb-4\\\">\\n                    <div class=\\\"card\\\">\\n                        <div class=\\\"card-body\\\">\\n                            <h5 class=\\\"card-title\\\">Bucket Statistics</h5>\\n                            <div class=\\\"stats-grid\\\">\\n                                <div class=\\\"stat-item\\\">\\n                                    <h6>Total Files</h6>\\n                                    <p class=\\\"h3 text-primary\\\">\".concat(totalFiles, \"</p>\\n                                </div>\\n                                <div class=\\\"stat-item\\\">\\n                                    <h6>Total Size</h6>\\n                                    <p class=\\\"h3 text-success\\\">\").concat(sizeDisplay, \"</p>\\n                                </div>\\n                                <div class=\\\"stat-item\\\">\\n                                    <h6>Average File Size</h6>\\n                                    <p class=\\\"h3 text-info\\\">\").concat((sizeInMB / (totalFiles || 1)).toFixed(2), \" MB</p>\\n                                </div>\\n                            </div>\\n                        </div>\\n                    </div>\\n                </div>\\n            \");\n                s3InfoContent = document.getElementById('s3-info-content');\n                if (s3InfoContent) {\n                  console.log('s3-info-content element found:', s3InfoContent);\n                  s3InfoContent.innerHTML = bucketDetails;\n                } else {\n                  console.error('Element with ID \"s3-info-content\" not found');\n                }\n                $('#s3InfoModal').modal('show');\n                _context3.next = 21;\n                break;\n              case 17:\n                _context3.prev = 17;\n                _context3.t0 = _context3[\"catch\"](0);\n                console.error('Error fetching S3 info:', _context3.t0);\n                if (_context3.t0.code === 'InvalidAccessKeyId') {\n                  showToast('Invalid AWS Access Key Id. Please check your credentials.', 'danger');\n                } else {\n                  showToast('Failed to fetch S3 information. Please check console for details.', 'danger');\n                }\n              case 21:\n              case \"end\":\n                return _context3.stop();\n            }\n          }, _callee3, null, [[0, 17]]);\n        })));\n\n        // Upload button handler\n        document.getElementById('upload-button').addEventListener('click', /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n          var folderInput, errorMessage, progressBar, progressBarInner, existingFiles, existingKeys, newFilesCount, totalSize, uploadProgress;\n          return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n            while (1) switch (_context4.prev = _context4.next) {\n              case 0:\n                folderInput = document.getElementById('folder-upload');\n                errorMessage = document.getElementById('error-message');\n                progressBar = document.getElementById('upload-progress');\n                progressBarInner = progressBar.querySelector('.progress-bar');\n                if (folderInput.files.length) {\n                  _context4.next = 7;\n                  break;\n                }\n                if (errorMessage) {\n                  errorMessage.classList.remove('d-none');\n                } else {\n                  console.error('Element not found');\n                }\n                return _context4.abrupt(\"return\");\n              case 7:\n                if (errorMessage) {\n                  errorMessage.classList.add('d-none');\n                } else {\n                  console.error('Element not found');\n                }\n                if (progressBar) {\n                  progressBar.classList.remove('d-none');\n                } else {\n                  console.error('Element not found');\n                }\n                _context4.prev = 9;\n                _context4.next = 12;\n                return s3.listObjectsV2({\n                  Bucket: \"awsmusicbackupbucket\",\n                  Prefix: currentPrefix\n                }).promise();\n              case 12:\n                existingFiles = _context4.sent;\n                existingKeys = new Set(existingFiles.Contents.map(function (item) {\n                  return item.Key;\n                }));\n                newFilesCount = 0;\n                totalSize = 0;\n                _context4.next = 18;\n                return uploadFiles(folderInput.files, currentPrefix);\n              case 18:\n                uploadProgress = _context4.sent;\n                newFilesCount = uploadProgress.current;\n                totalSize = uploadProgress.size;\n                if (!(newFilesCount === 0)) {\n                  _context4.next = 25;\n                  break;\n                }\n                showToast('No new files to upload.', 'warning');\n                _context4.next = 30;\n                break;\n              case 25:\n                showToast('Folder uploaded successfully.', 'success');\n                _context4.next = 28;\n                return updateHistory('Upload', totalSize, newFilesCount);\n              case 28:\n                _context4.next = 30;\n                return _fetchS3Contents(currentPrefix);\n              case 30:\n                _context4.next = 36;\n                break;\n              case 32:\n                _context4.prev = 32;\n                _context4.t0 = _context4[\"catch\"](9);\n                console.error('Error uploading files:', _context4.t0);\n                showToast('Error uploading files. Please check console for details.', 'danger');\n              case 36:\n                _context4.prev = 36;\n                if (progressBar) {\n                  progressBar.classList.add('d-none');\n                } else {\n                  console.error('Element not found');\n                }\n                if (progressBarInner) {\n                  progressBarInner.style.width = '0%';\n                } else {\n                  console.error('Element not found');\n                }\n                if (folderInput) {\n                  folderInput.value = '';\n                } else {\n                  console.error('Element not found');\n                }\n                return _context4.finish(36);\n              case 41:\n              case \"end\":\n                return _context4.stop();\n            }\n          }, _callee4, null, [[9, 32, 36, 41]]);\n        })));\n\n        // Function to handle file uploads with improved progress tracking\n\n        // Navigation and download handlers\n        document.getElementById('s3-contents').addEventListener('click', /*#__PURE__*/function () {\n          var _ref6 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(event) {\n            var prefix, key, data, blob, url, a, _prefix, params, _data, zip, totalSize, _iterator, _step, item, fileData, content, _url, _a;\n            return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n              while (1) switch (_context5.prev = _context5.next) {\n                case 0:\n                  if (!event.target.classList.contains('navigate-button')) {\n                    _context5.next = 6;\n                    break;\n                  }\n                  prefix = event.target.getAttribute('data-prefix');\n                  _context5.next = 4;\n                  return _fetchS3Contents(prefix);\n                case 4:\n                  _context5.next = 79;\n                  break;\n                case 6:\n                  if (!event.target.classList.contains('download-button')) {\n                    _context5.next = 31;\n                    break;\n                  }\n                  key = event.target.getAttribute('data-key');\n                  _context5.prev = 8;\n                  _context5.next = 11;\n                  return s3.getObject({\n                    Bucket: \"awsmusicbackupbucket\",\n                    Key: key\n                  }).promise();\n                case 11:\n                  data = _context5.sent;\n                  blob = new Blob([data.Body]);\n                  url = window.URL.createObjectURL(blob);\n                  a = document.createElement('a');\n                  a.href = url;\n                  a.download = key.split('/').pop();\n                  document.body.appendChild(a);\n                  a.click();\n                  window.URL.revokeObjectURL(url);\n                  document.body.removeChild(a);\n                  _context5.next = 23;\n                  return updateHistory('Download', data.ContentLength, 1);\n                case 23:\n                  _context5.next = 29;\n                  break;\n                case 25:\n                  _context5.prev = 25;\n                  _context5.t0 = _context5[\"catch\"](8);\n                  console.error('Error downloading file:', _context5.t0);\n                  showToast('Error downloading file. Please check console for details.', 'danger');\n                case 29:\n                  _context5.next = 79;\n                  break;\n                case 31:\n                  if (!event.target.classList.contains('download-folder-button')) {\n                    _context5.next = 79;\n                    break;\n                  }\n                  _prefix = event.target.getAttribute('data-prefix');\n                  _context5.prev = 33;\n                  params = {\n                    Bucket: \"awsmusicbackupbucket\",\n                    Prefix: _prefix\n                  };\n                  _context5.next = 37;\n                  return s3.listObjectsV2(params).promise();\n                case 37:\n                  _data = _context5.sent;\n                  zip = new JSZip();\n                  totalSize = 0;\n                  _iterator = _createForOfIteratorHelper(_data.Contents);\n                  _context5.prev = 41;\n                  _iterator.s();\n                case 43:\n                  if ((_step = _iterator.n()).done) {\n                    _context5.next = 52;\n                    break;\n                  }\n                  item = _step.value;\n                  _context5.next = 47;\n                  return s3.getObject({\n                    Bucket: \"awsmusicbackupbucket\",\n                    Key: item.Key\n                  }).promise();\n                case 47:\n                  fileData = _context5.sent;\n                  zip.file(item.Key.replace(_prefix, ''), fileData.Body);\n                  totalSize += fileData.ContentLength;\n                case 50:\n                  _context5.next = 43;\n                  break;\n                case 52:\n                  _context5.next = 57;\n                  break;\n                case 54:\n                  _context5.prev = 54;\n                  _context5.t1 = _context5[\"catch\"](41);\n                  _iterator.e(_context5.t1);\n                case 57:\n                  _context5.prev = 57;\n                  _iterator.f();\n                  return _context5.finish(57);\n                case 60:\n                  _context5.next = 62;\n                  return zip.generateAsync({\n                    type: 'blob'\n                  });\n                case 62:\n                  content = _context5.sent;\n                  _url = window.URL.createObjectURL(content);\n                  _a = document.createElement('a');\n                  _a.href = _url;\n                  _a.download = \"\".concat(_prefix.split('/').slice(-2, -1)[0], \".zip\");\n                  document.body.appendChild(_a);\n                  _a.click();\n                  window.URL.revokeObjectURL(_url);\n                  document.body.removeChild(_a);\n                  _context5.next = 73;\n                  return updateHistory('Download', totalSize, _data.Contents.length);\n                case 73:\n                  _context5.next = 79;\n                  break;\n                case 75:\n                  _context5.prev = 75;\n                  _context5.t2 = _context5[\"catch\"](33);\n                  console.error('Error downloading folder:', _context5.t2);\n                  showToast('Error downloading folder. Please check console for details.', 'danger');\n                case 79:\n                case \"end\":\n                  return _context5.stop();\n              }\n            }, _callee5, null, [[8, 25], [33, 75], [41, 54, 57, 60]]);\n          }));\n          return function (_x9) {\n            return _ref6.apply(this, arguments);\n          };\n        }());\n\n        // Navigate Up button handler\n        document.getElementById('navigate-up-button').addEventListener('click', function () {\n          var parts = currentPrefix.split('/').filter(Boolean);\n          if (parts.length > 0) {\n            parts.pop();\n            _fetchS3Contents(parts.join('/') + '/');\n          } else {\n            _fetchS3Contents('');\n          }\n        });\n\n        // Folders link handler\n        document.getElementById('folders-link').addEventListener('click', function () {\n          document.getElementById('folders-section').classList.remove('d-none');\n          document.getElementById('history-section').classList.add('d-none');\n          document.getElementById('cost-section').classList.add('d-none');\n          _fetchS3Contents(currentPrefix);\n        });\n\n        // History link handler\n        document.getElementById('history-link').addEventListener('click', function () {\n          document.getElementById('folders-section').classList.add('d-none');\n          document.getElementById('history-section').classList.remove('d-none');\n          document.getElementById('cost-section').classList.add('d-none');\n        });\n\n        // Cost link handler\n        document.getElementById('cost-link').addEventListener('click', function () {\n          document.getElementById('folders-section').classList.add('d-none');\n          document.getElementById('history-section').classList.add('d-none');\n          document.getElementById('cost-section').classList.remove('d-none');\n          $('#costModal').modal('show');\n          fetchAWSCost();\n        });\n\n        // Home link handler\n        document.getElementById('home-link').addEventListener('click', function () {\n          document.getElementById('folders-section').classList.add('d-none');\n          document.getElementById('history-section').classList.add('d-none');\n          document.getElementById('cost-section').classList.add('d-none');\n          var s3Contents = document.getElementById('s3-contents');\n          if (s3Contents) {\n            s3Contents.innerHTML = '';\n          } else {\n            console.error('Element not found');\n          }\n        });\n\n        // Clear history button handler\n        document.getElementById('clear-history-button').addEventListener('click', function () {\n          var clearHistoryModal = \"\\n            <div class=\\\"modal fade\\\" id=\\\"clearHistoryModal\\\" tabindex=\\\"-1\\\" role=\\\"dialog\\\" aria-labelledby=\\\"clearHistoryModalLabel\\\" aria-hidden=\\\"true\\\">\\n                <div class=\\\"modal-dialog\\\" role=\\\"document\\\">\\n                    <div class=\\\"modal-content\\\">\\n                        <div class=\\\"modal-header\\\">\\n                            <h5 class=\\\"modal-title\\\" id=\\\"clearHistoryModalLabel\\\">Clear History</h5>\\n                            <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"modal\\\" aria-label=\\\"Close\\\">\\n                                <span aria-hidden=\\\"true\\\">&times;</span>\\n                            </button>\\n                        </div>\\n                        <div class=\\\"modal-body\\\">\\n                            Are you sure you want to clear the history?\\n                        </div>\\n                        <div class=\\\"modal-footer\\\">\\n                            <button type=\\\"button\\\" class=\\\"btn btn-secondary\\\" data-dismiss=\\\"modal\\\">Cancel</button>\\n                            <button type=\\\"button\\\" class=\\\"btn btn-danger\\\" id=\\\"confirm-clear-history\\\">Clear History</button>\\n                        </div>\\n                    </div>\\n                </div>\\n            </div>\\n        \";\n          document.body.insertAdjacentHTML('beforeend', clearHistoryModal);\n          $('#clearHistoryModal').modal('show');\n          document.getElementById('confirm-clear-history').addEventListener('click', /*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n            var historyContents, params;\n            return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n              while (1) switch (_context6.prev = _context6.next) {\n                case 0:\n                  history = [];\n                  historyContents = document.getElementById('history-contents');\n                  if (historyContents) {\n                    historyContents.innerHTML = '';\n                  } else {\n                    console.error('Element not found');\n                  }\n                  showToast('History cleared.', 'success');\n\n                  // Clear history in S3\n                  params = {\n                    Bucket: \"awsmusicbackupbucket\",\n                    Key: 'history-log.json',\n                    Body: JSON.stringify(history),\n                    ContentType: 'application/json'\n                  };\n                  _context6.next = 7;\n                  return s3.putObject(params).promise();\n                case 7:\n                  // Hide the modal\n                  $('#clearHistoryModal').modal('hide');\n                  $('#clearHistoryModal').on('hidden.bs.modal', function () {\n                    var clearHistoryModalElement = document.getElementById('clearHistoryModal');\n                    if (clearHistoryModalElement) {\n                      clearHistoryModalElement.remove();\n                    } else {\n                      console.error('Element not found');\n                    }\n                  });\n                case 9:\n                case \"end\":\n                  return _context6.stop();\n              }\n            }, _callee6);\n          })));\n        });\n\n        // Initial fetch of S3 contents\n        _fetchS3Contents();\n\n        // Load history from S3\n        loadHistory();\n\n        // Custom file input label update\n        $('#folder-upload').on('change', function () {\n          var fileName = $(this).val().split('\\\\').pop();\n          $(this).next('.custom-file-label').addClass('selected').html(fileName);\n        });\n\n        // Function to show toast with improved notifications\n\n        // Update the Home link handler\n        document.getElementById('home-link').addEventListener('click', function () {\n          // Hide all sections except upload section\n          document.getElementById('folders-section').classList.add('d-none');\n          document.getElementById('history-section').classList.add('d-none');\n          document.getElementById('cost-section').classList.add('d-none');\n\n          // Show upload section\n          document.querySelector('.upload-section').classList.remove('d-none');\n\n          // Clear any active modals\n          $('.modal').modal('hide');\n          $('body').removeClass('modal-open');\n          $('.modal-backdrop').remove();\n\n          // Remove active class from all nav items\n          document.querySelectorAll('.nav-item').forEach(function (item) {\n            item.classList.remove('active');\n          });\n\n          // Add active class to home link\n          this.parentElement.classList.add('active');\n        });\n\n        // Update the Folders link handler\n        document.getElementById('folders-link').addEventListener('click', function () {\n          // Show folders section and hide others\n          document.getElementById('folders-section').classList.remove('d-none');\n          document.getElementById('history-section').classList.add('d-none');\n          document.getElementById('cost-section').classList.add('d-none');\n          document.querySelector('.upload-section').classList.add('d-none');\n\n          // Update navigation active state\n          document.querySelectorAll('.nav-item').forEach(function (item) {\n            item.classList.remove('active');\n          });\n          this.parentElement.classList.add('active');\n\n          // Refresh folders content\n          _fetchS3Contents(currentPrefix);\n        });\n\n        // Update the History link handler\n        document.getElementById('history-link').addEventListener('click', function () {\n          // Show history section and hide others\n          document.getElementById('folders-section').classList.add('d-none');\n          document.getElementById('history-section').classList.remove('d-none');\n          document.getElementById('cost-section').classList.add('d-none');\n          document.querySelector('.upload-section').classList.add('d-none');\n\n          // Update navigation active state\n          document.querySelectorAll('.nav-item').forEach(function (item) {\n            item.classList.remove('active');\n          });\n          this.parentElement.classList.add('active');\n        });\n\n        // Add modal cleanup code\n        $(document).on('hidden.bs.modal', '.modal', function () {\n          // Remove modal-related classes and elements\n          $('body').removeClass('modal-open');\n          $('.modal-backdrop').remove();\n        });\n      case 49:\n      case \"end\":\n        return _context12.stop();\n    }\n  }, _callee12, null, [[17, 23]]);\n})));\n\n// Update the initial state\nwindow.addEventListener('DOMContentLoaded', function () {\n  document.getElementById('folders-section').classList.add('d-none');\n  document.getElementById('history-section').classList.add('d-none');\n  document.getElementById('cost-section').classList.add('d-none');\n});\n\n// Update the tab click handlers with null checks\nfunction updateActiveTab(clickedTab) {\n  // Hide all sections with null checks\n  var sections = ['folders-section', 'history-section', 'cost-section'];\n  sections.forEach(function (section) {\n    var sectionElement = document.getElementById(section);\n    if (sectionElement) {\n      sectionElement.classList.add('d-none');\n    }\n  });\n\n  // Hide upload section except for home\n  var uploadSection = document.querySelector('.upload-section');\n  if (uploadSection) {\n    if (clickedTab !== 'home-link') {\n      uploadSection.classList.add('d-none');\n    } else {\n      uploadSection.classList.remove('d-none');\n    }\n  }\n\n  // Remove active class from all nav items with null check\n  var navItems = document.querySelectorAll('.nav-item');\n  if (navItems) {\n    navItems.forEach(function (item) {\n      if (item) {\n        item.classList.remove('active');\n      }\n    });\n  }\n\n  // Add active class to clicked tab with null check\n  var clickedElement = document.querySelector(\"#\".concat(clickedTab));\n  if (clickedElement && clickedElement.parentElement) {\n    clickedElement.parentElement.classList.add('active');\n  }\n\n  // Close any open modals\n  $('.modal').modal('hide');\n  cleanupModals();\n}\n\n// Ensure DOM is fully loaded before adding event listeners\ndocument.addEventListener('DOMContentLoaded', function () {\n  // Add event listeners with null checks\n  var navigationLinks = {\n    'home-link': function homeLink() {\n      updateActiveTab('home-link');\n    },\n    'folders-link': function foldersLink() {\n      updateActiveTab('folders-link');\n      var foldersSection = document.getElementById('folders-section');\n      if (foldersSection) {\n        foldersSection.classList.remove('d-none');\n        _fetchS3Contents(currentPrefix);\n      }\n    },\n    'history-link': function historyLink() {\n      updateActiveTab('history-link');\n      var historySection = document.getElementById('history-section');\n      if (historySection) {\n        historySection.classList.remove('d-none');\n      }\n    },\n    'cost-link': function costLink() {\n      updateActiveTab('cost-link');\n      $('#costModal').modal('show');\n    },\n    's3-info-link': function s3InfoLink() {\n      updateActiveTab('s3-info-link');\n      $('#s3InfoModal').modal({\n        backdrop: 'static',\n        keyboard: true,\n        focus: true\n      });\n    }\n  };\n\n  // Add click handlers with proper scoping\n  Object.entries(navigationLinks).forEach(function (_ref8) {\n    var _ref9 = _slicedToArray(_ref8, 2),\n      id = _ref9[0],\n      handler = _ref9[1];\n    var element = document.getElementById(id);\n    if (element) {\n      element.addEventListener('click', function (e) {\n        e.preventDefault();\n        handler();\n      });\n    }\n  });\n\n  // Initialize sections state\n  var sectionsToHide = ['folders-section', 'history-section', 'cost-section'];\n  sectionsToHide.forEach(function (sectionId) {\n    var section = document.getElementById(sectionId);\n    if (section) {\n      section.classList.add('d-none');\n    }\n  });\n});\n\n// Function to clean up modals\nfunction cleanupModals() {\n  try {\n    $('body').removeClass('modal-open');\n    $('.modal-backdrop').remove();\n    var modals = document.querySelectorAll('.modal');\n    modals.forEach(function (modal) {\n      if (modal) {\n        modal.removeAttribute('aria-hidden');\n      }\n    });\n  } catch (error) {\n    console.error('Error cleaning up modals:', error);\n  }\n}\n\n// Update the navigation handlers with error handling\nvar setupNavigationHandlers = function setupNavigationHandlers() {\n  var handlers = {\n    'home-link': function homeLink() {\n      var homeLink = document.getElementById('home-link');\n      if (homeLink) {\n        homeLink.addEventListener('click', function (e) {\n          e.preventDefault();\n          updateActiveTab('home-link');\n        });\n      }\n    },\n    'folders-link': function foldersLink() {\n      var foldersLink = document.getElementById('folders-link');\n      if (foldersLink) {\n        foldersLink.addEventListener('click', function (e) {\n          e.preventDefault();\n          updateActiveTab('folders-link');\n          var foldersSection = document.getElementById('folders-section');\n          if (foldersSection) {\n            foldersSection.classList.remove('d-none');\n            if (typeof _fetchS3Contents === 'function') {\n              _fetchS3Contents(currentPrefix);\n            }\n          }\n        });\n      }\n    }\n    // ...other handlers\n  };\n  Object.values(handlers).forEach(function (handler) {\n    try {\n      handler();\n    } catch (error) {\n      console.error('Error setting up handler:', error);\n    }\n  });\n};\n\n// Call the setup function after DOM is loaded\nsetupNavigationHandlers();\n\n// Update the fetchS3Contents function\n_fetchS3Contents = /*#__PURE__*/function () {\n  var _ref10 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee13() {\n    var prefix,\n      _args13 = arguments;\n    return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n      while (1) switch (_context13.prev = _context13.next) {\n        case 0:\n          prefix = _args13.length > 0 && _args13[0] !== undefined ? _args13[0] : '';\n          try {\n            currentPrefix = prefix;\n            // ...rest of fetchS3Contents implementation...\n          } catch (err) {\n            console.error('Error in fetchS3Contents:', err);\n          }\n        case 2:\n        case \"end\":\n          return _context13.stop();\n      }\n    }, _callee13);\n  }));\n  return function _fetchS3Contents() {\n    return _ref10.apply(this, arguments);\n  };\n}();\n\n// Update event listeners for modals with error handling\nvar setupModalHandlers = function setupModalHandlers() {\n  var modals = document.querySelectorAll('.modal');\n  modals.forEach(function (modal) {\n    if (modal) {\n      $(modal).on('hidden.bs.modal', cleanupModals);\n    }\n  });\n};\n\n// Initialize the application\nvar initializeApp = /*#__PURE__*/function () {\n  var _ref11 = _asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee14() {\n    return _regeneratorRuntime().wrap(function _callee14$(_context14) {\n      while (1) switch (_context14.prev = _context14.next) {\n        case 0:\n          _context14.prev = 0;\n          _context14.next = 3;\n          return _fetchS3Contents('');\n        case 3:\n          _context14.next = 5;\n          return loadHistory();\n        case 5:\n          setupModalHandlers();\n          _context14.next = 12;\n          break;\n        case 8:\n          _context14.prev = 8;\n          _context14.t0 = _context14[\"catch\"](0);\n          console.error('Error initializing app:', _context14.t0);\n          showToast('Error initializing application', 'danger');\n        case 12:\n        case \"end\":\n          return _context14.stop();\n      }\n    }, _callee14, null, [[0, 8]]);\n  }));\n  return function initializeApp() {\n    return _ref11.apply(this, arguments);\n  };\n}();\n\n// Start the initialization\ninitializeApp();\n\n//# sourceURL=webpack:///./app.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = {};
/******/ 	__webpack_modules__["./app.js"]();
/******/ 	
/******/ })()
;